<script type="module">
  const app = document.getElementById("app");

  function showError(msg) {
    const div = document.createElement("div");
    div.style.cssText = `
      position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
      background:rgba(0,0,0,0.55); color:rgba(245,250,255,0.92); padding:24px; text-align:left;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      z-index:9999;
    `;
    div.innerHTML = `
      <div style="max-width:720px;border:1px solid rgba(255,255,255,0.16);border-radius:18px;
                  background:rgba(10,18,28,0.65);backdrop-filter:blur(10px);padding:18px 18px 14px;">
        <div style="font-weight:700; letter-spacing:.08em; text-transform:uppercase; font-size:12px; opacity:.9;">
          Ocean Wave Simulation
        </div>
        <div style="margin-top:10px; font-size:14px; line-height:1.4; opacity:.85;">
          ${msg}
        </div>
        <div style="margin-top:10px; font-size:12px; opacity:.7;">
          Tip: If youâ€™re on a restricted network, try a different Wi-Fi or self-host the libraries.
        </div>
      </div>
    `;
    document.body.appendChild(div);
  }

  // Quick WebGL check
  try {
    const c = document.createElement("canvas");
    const gl = c.getContext("webgl") || c.getContext("experimental-webgl");
    if (!gl) throw new Error("WebGL is not available in this browser/device.");
  } catch (e) {
    showError(`WebGL couldn't start: ${e.message}`);
    throw e;
  }

  // Dynamic imports (catch CDN/module failures)
  let THREE, OrbitControls;
  try {
    const threeMod = await import("https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js");
    THREE = threeMod;

    const controlsMod = await import("https://cdn.
